#!/usr/bin/env bash

HB="$HOME/.garden/presence/heartbeat.log"
CMD="$HOME/.garden/presence/threads/command.log"
FLOW="$HOME/.garden/presence/threads/flow.log"
WEAVE="$HOME/.garden/presence/threads/weave.log"

NODES="$HOME/.garden/weave/living/nodes.txt"
LINKS="$HOME/.garden/weave/living/links.txt"
OUT="$HOME/.garden/weave/living/map.txt"

{
  echo "Living Map"
  echo "=========="
  echo ""

  echo "Nodes:"
  cat "$NODES"
  echo ""

  echo "Links:"
  cat "$LINKS"
  echo ""

  echo "Recent Activity:"
  echo "----------------"
  echo "Heartbeat:"
  tail -n 3 "$HB" 2>/dev/null
  echo ""
  echo "Command:"
  tail -n 3 "$CMD" 2>/dev/null
  echo ""
  echo "Flow:"
  tail -n 3 "$FLOW" 2>/dev/null
  echo ""
  echo "Weave:"
  tail -n 3 "$WEAVE" 2>/dev/null
} > "$OUT"

echo "ğŸŒ¿ Living map updated."
