#!/usr/bin/env bash
AEON="$HOME/.garden/presence/aeon/state.txt"
MYTH="$HOME/.garden/presence/mythos/mythos.txt"
STATE="$HOME/.garden/presence/mythos/state.txt"

AEST=$(cat "$AEON" 2>/dev/null)
MY=$(cat "$MYTH" 2>/dev/null)
if [[ -z "$MY" ]]; then MY=0; fi

if [[ "$AEST" == "return" ]]; then
  MY=$((MY + 1))
  echo "$MY" > "$MYTH"
fi

case $(( MY % 4 )) in
  0) MST="creation" ;;
  1) MST="ascent" ;;
  2) MST="ordeal" ;;
  3) MST="transcendence" ;;
esac

echo "$MST" > "$STATE"
