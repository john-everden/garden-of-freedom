#!/usr/bin/env bash
MYTH="$HOME/.garden/presence/mythos/state.txt"
COS="$HOME/.garden/presence/cosmos/cosmos.txt"
STATE="$HOME/.garden/presence/cosmos/state.txt"

MY=$(cat "$MYTH" 2>/dev/null)
C=$(cat "$COS" 2>/dev/null)
if [[ -z "$C" ]]; then C=0; fi

if [[ "$MY" == "transcendence" ]]; then
  C=$((C + 1))
  echo "$C" > "$COS"
fi

case $(( C % 4 )) in
  0) CST="void" ;;
  1) CST="spark" ;;
  2) CST="order" ;;
  3) CST="inversion" ;;
esac

echo "$CST" > "$STATE"
